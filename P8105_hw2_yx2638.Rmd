---
title: "P8105_hw2_yx2638"
author: "Yifei Xu"
date: "2022-09-28"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
```


# Problem 1

```{r}
# Read and clean the data
transit_df = read_csv("data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>%
        janitor::clean_names() %>%
        select(line, station_name, station_latitude, station_longitude, route1:route11, entry, vending, 
               entrance_type,  ada) %>%
        mutate(entry = recode(entry, "YES" = "TRUE", "NO" = "FALSE"),
               entry = as.logical(entry))


# names of important variables
variable_name = names(transit_df)

# size of the dataset 
row = nrow(transit_df)
col = ncol(transit_df)
```

```{r}
# Count the number of distinct stations
station_num = nrow(distinct(transit_df, line, station_name))

# Count the number of stations that are ADA compliant
ada_station_num = transit_df %>%
        filter(ada == "TRUE") %>%
        distinct(line, station_name) %>%
        nrow()

# Calculte the proportion of station entrances / exits without vending allow entrance?????
no_vending_extrance_num = transit_df %>%
        filter(entry == "TRUE", vending == "NO") %>%
        distinct(line, station_name) %>%
        nrow()

entrance_num = transit_df %>%
        filter(entry == "TRUE") %>%
        distinct(line, station_name) %>%
        nrow()

no_vending_extrance_prop = scales::percent(no_vending_extrance_num / entrance_num, 0.01)
```

```{r}
# Reformat data so that route number and route name are distinct variables
transit_df_tidy = transit_df %>%
        mutate(
                route8 = as.character(route8),
                route9 = as.character(route9),
                route10 = as.character(route10),
                route11 = as.character(route11)
               ) %>%
        pivot_longer(
                route1:route11,
                names_to = "route_number",
                values_to = "route_name"
                )

# Count the number of distinct stations serve the A train
station_a_num = transit_df_tidy %>%
        filter(route_name == "A") %>%
        distinct(line, station_name) %>%
        nrow()

# Count the number of ADA compliant of the stations that serve the A train
station_a_ada_num = transit_df_tidy %>%
        filter(route_name == "A", ada == "TRUE") %>%
        distinct(line, station_name) %>%
        nrow()
        
```

